>Q1. Find the titles of all movies directed by Steven Spielberg. 

select title
from Movie
where director = "Steven Spielberg"

>Q2. Find all years that have a movie that received a rating of 4 or 5, and sort them in increasing order. 

select distinct year
from Movie, Rating 
where Rating.stars >= 4 and Movie.mID = Rating.mID
order by year asc

>Q3

select title 
from Movie 
where mID not in (select mID from Rating)

>Q4

select name 
from Reviewer
where rID in (select rID from Rating where ratingDate is null)

>Q5

select name, title, stars, ratingDate
from Reviewer, Rating, Movie 
where Reviewer.rID = Rating.rID and Rating.mID = Movie.mID
order by name asc, title asc, stars asc

>Q6

select name, title
from Movie, Reviewer, Rating R1, Rating R2
where Movie.mID = R1.mID and Movie.mID = R2.mID and Reviewer.rID = R1.rID and Reviewer.rID = R2.rID /*match tables by mID & rID*/
    and R1.ratingDate < R2.ratingDate and R1.stars < R2.stars and R1.rID = R2.rID /*condition to find unique second ratings higher than original rating*/

>Q7

select title, max(stars)
from Movie join Rating using(mID)
group by mID
order by title

>Q8

select title, (max(stars)-min(stars)) as spread
from Movie join Rating using(mID)
group by mID
order by spread desc, title asc

>Q9

select (pre80-post80) 
from (
    select avg(avgStars) as post80 from (
        select avg(stars) as avgStars
        from Movie join Rating using(mID)
        group by title
        having year >= 1980 and stars is not null
        )
      ),
    (
    select avg(avgStars) as pre80 from (
      select avg(stars) as avgStars
      from Movie join Rating using(mID)
      group by title
      having year < 1980 and stars is not null
      )
    );
